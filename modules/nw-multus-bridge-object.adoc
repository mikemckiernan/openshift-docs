// Module included in the following assemblies:
//
// * networking/multiple_networks/configuring-bridge.adoc

[id="nw-multus-bridge-object_{context}"]
= Configuration for bridge

The following object describes the configuration parameters for the bridge Container Network Interface (CNI) plug-in:

// containernetworking/plugins/.../bridge.go#47
.bridge CNI plug-in JSON configuration object
[source,json]
----
{
  "cniVersion": "0.4.0",
  "name": "<name>", <1>
  "type": "bridge",
  "bridge": "<bridge>", <2>
  "ipam": { <3>
    ...
  },
  "ipMasq": false, <4>
  "isGateway": false, <5>
  "isDefaultGateway": false, <6>
  "forceAddress": false, <7>
  "hairpinMode": false, <8>
  "promiscMode": false, <9>
  "vlan": <vlan>, <10>
  "mtu": <mtu> <11>
}
----
<1> Specify the name for the network.

<2> Specify the name of the virtual bridge to use. If the bridge
interface does not exist on the host, it is created. The default value is
`cni0`.

<3> Specify a configuration object for the IPAM CNI plug-in. The plug-in
manages IP address assignment for the network attachment definition.

<4> Specify `true` to enable IP masquerading for traffic that leaves the
virtual network. The source IP address for all traffic is rewritten to the
IP address of the bridge. If the bridge does not have an IP address, this setting has no effect. The default value is `false`.

<5> Specify `true` to assign an IP address to the bridge. The
default value is `false`.

<6> Specify `true` to configure the bridge as the default
gateway for the virtual network. The default value is `false`. If you set
`isDefaultGateway` to `true`, then `isGateway` is set to `true`
automatically.

<7> Specify `true` to allow assignment of a previously assigned
IP address to the virtual bridge. When set to `false`, if an IPv4 address or an
IPv6 address from overlapping subsets is assigned to the virtual bridge, an
error occurs. The default value is `false`.

<8> Specify `true` to allow the virtual bridge to send an Ethernet
frame back through the virtual port it was received on. This mode is also known
as _reflective relay_. The default value is `false`.

<9> Specify `true` to enable promiscuous mode on the bridge. The
default value is `false`.

<10> Specify a virtual LAN (VLAN) tag as an integer value. By default,
no VLAN tag is assigned.

<11> Specify the maximum transmission unit (MTU) for the network interface. The
default value is automatically set by the kernel.

[id="nw-multus-bridge-config-example_{context}"]
== bridge configuration example

The following example shows a network attachment definition that configures an additional network named `bridge-net-dhcp`:

[source,yaml]
----
apiVersion: k8s.cni.cncf.io/v1
kind: NetworkAttachmentDefinition
metadata:
  name: bridge-net-dhcp  <.>
  namespace: work-network
spec:
  config: '{
    "cniVersion": "0.4.0",
    "name": "work-network",
    "type": "bridge",
    "isGateway": true,
    "vlan": 2,
    "ipam": {
      "type": "dhcp"
      }
  }'
----
<.> To use the network, a pod specification must reference the network attachment definition name.
